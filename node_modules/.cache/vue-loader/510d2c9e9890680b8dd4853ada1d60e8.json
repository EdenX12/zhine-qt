{"remainingRequest":"D:\\Work\\jianpanHt\\jpqt\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Work\\jianpanHt\\jpqt\\src\\pages\\shop\\ShopManage.vue?vue&type=style&index=0&id=3ab17a13&scoped=true&lang=css&","dependencies":[{"path":"D:\\Work\\jianpanHt\\jpqt\\src\\pages\\shop\\ShopManage.vue","mtime":1591608111701},{"path":"D:\\Work\\jianpanHt\\jpqt\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\Work\\jianpanHt\\jpqt\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\Work\\jianpanHt\\jpqt\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\Work\\jianpanHt\\jpqt\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Work\\jianpanHt\\jpqt\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.table-banner-img {\r\n  display: block;\r\n  margin: auto;\r\n  width: 50px;\r\n  height: 50px;\r\n}\r\n.handle-box {\r\n  margin-bottom: 10px;\r\n  text-align: left;\r\n}\r\n.name-input {\r\n  width: 200px;\r\n  margin-right: 10px;\r\n}\r\n.status-select {\r\n  margin-right: 10px;\r\n}\r\n.inner-drawer-tittle {\r\n  font-size: 18px;\r\n  color: #303133;\r\n  line-height: 50px;\r\n}\r\n",{"version":3,"sources":["ShopManage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0vBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ShopManage.vue","sourceRoot":"src/pages/shop","sourcesContent":["<template>\r\n  <div style=\"margin-top:10px;\">\r\n    <div class=\"container\">\r\n      <!--搜索条件-->\r\n      <div class=\"handle-box\">\r\n        <el-input v-model=\"query.shopName\" placeholder=\"请输入店铺名称\" class=\"name-input\"></el-input>\r\n        <el-input v-model=\"query.legalPerson\" placeholder=\"请输入法人姓名\" class=\"name-input\"></el-input>\r\n        <el-input v-model=\"query.mobile\" placeholder=\"请输入联系手机\" class=\"name-input\"></el-input>\r\n        <el-button type=\"primary\" round icon=\"el-icon-search\" @click=\"handleSearch()\">搜索</el-button>\r\n        <el-button type=\"danger\" round icon=\"el-icon-refresh\" @click=\"resetQuery()\">重置</el-button>\r\n        <el-button type=\"primary\" round icon=\"el-icon-circle-plus-outline\" @click=\"handleAdd()\">添加</el-button>\r\n      </div>\r\n      <!--数据表单-->\r\n      <el-table\r\n        :data=\"tableData\"\r\n        :header-cell-style=\"tableHeaderColor\"\r\n        class=\"table\"\r\n        ref=\"multipleTable\"\r\n        header-cell-class-name=\"table-header\"\r\n        v-loading=\"tableDataLoading\"\r\n      >\r\n        <el-table-column label=\"序号\" type=\"index\" width=\"50\" align=\"center\"></el-table-column>\r\n        <el-table-column label=\"店铺logo\" width=\"200px\" align=\"center\">\r\n          <template slot-scope=\"scope\">\r\n            <el-image\r\n              class=\"table-banner-img\"\r\n              :src=\"scope.row.shopLogo\"\r\n              :preview-src-list=\"[scope.row.shopLogo]\"\r\n            ></el-image>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"shopName\" label=\"店铺名称\" align=\"center\" :show-overflow-tooltip=\"true\"></el-table-column>\r\n        <el-table-column prop=\"shopStar\" label=\"店铺星级\" width=\"120px\" align=\"center\"></el-table-column>\r\n        <el-table-column\r\n          prop=\"shopScore\"\r\n          label=\"店铺评价分\"\r\n          align=\"center\"\r\n          width=\"120px\"\r\n          :show-overflow-tooltip=\"true\"\r\n        ></el-table-column>\r\n        <el-table-column\r\n          prop=\"shopService\"\r\n          label=\"店铺评价分\"\r\n          align=\"center\"\r\n          width=\"120px\"\r\n          :show-overflow-tooltip=\"true\"\r\n        ></el-table-column>\r\n        <el-table-column\r\n          prop=\"legalPerson\"\r\n          label=\"法人代表\"\r\n          align=\"center\"\r\n          width=\"80px\"\r\n          :show-overflow-tooltip=\"true\"\r\n        ></el-table-column>\r\n        <el-table-column prop=\"startDate\" label=\"开店时间\" :formatter=\"startDateFormat\" align=\"center\"></el-table-column>\r\n        <el-table-column label=\"操作\" align=\"center\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button\r\n              type=\"primary\"\r\n              icon=\"el-icon-more-outline\"\r\n              circle\r\n              @click=\"handleMore(scope.$index, scope.row)\"\r\n            ></el-button>\r\n            <el-button\r\n              type=\"primary\"\r\n              icon=\"el-icon-edit\"\r\n              circle\r\n              @click=\"handleEdit(scope.$index, scope.row)\"\r\n            ></el-button>\r\n            <el-button\r\n              type=\"danger\"\r\n              icon=\"el-icon-delete\"\r\n              circle\r\n              @click=\"handleDelete(scope.$index, scope.row)\"\r\n            ></el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <!-- 分页 -->\r\n      <div class=\"pagination\">\r\n        <el-pagination\r\n          background\r\n          layout=\"total, prev, pager, next\"\r\n          :current-page=\"query.pageNum\"\r\n          :page-size=\"query.pageSize\"\r\n          :total=\"pageTotal\"\r\n          @current-change=\"handlePageChange\"\r\n        ></el-pagination>\r\n      </div>\r\n      <!-- 弹出框 -->\r\n      <el-dialog\r\n        :title=\"dialogMessage\"\r\n        :visible.sync=\"editVisible\"\r\n        :center=\"dialogCentr\"\r\n        @close=\"closeDialog\"\r\n        top=\"50px\"\r\n      >\r\n        <el-form\r\n          :rules=\"ruleValidate\"\r\n          ref=\"saveForm\"\r\n          :model=\"saveForm\"\r\n          :inline=\"true\"\r\n          :lable-position=\"labelPosition\"\r\n          label-width=\"120px\"\r\n        >\r\n          <el-form-item label=\"店铺名称\" prop=\"shopName\">\r\n            <el-input v-model=\"saveForm.shopName\" placeholder=\"请输入店铺名称\" suffix-icon=\"“xxxx”\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"店铺星级\" prop=\"shopStar\">\r\n            <el-input v-model=\"saveForm.shopStar\" placeholder=\"请输入店铺星级\" suffix-icon=\"“xxxx”\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"店铺评价分\" prop=\"shopScore\">\r\n            <el-input v-model=\"saveForm.shopScore\" placeholder=\"请输入店铺评价分\" suffix-icon=\"“xxxx”\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"售后服务分\" prop=\"shopService\">\r\n            <el-input v-model=\"saveForm.shopService\" placeholder=\"请输入售后服务分\" suffix-icon=\"“xxxx”\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"法人代表\" prop=\"legalPerson\">\r\n            <el-input v-model=\"saveForm.legalPerson\" placeholder=\"请输入法姓名\" suffix-icon=\"“xxxx”\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"联系手机\" prop=\"mobile\">\r\n            <el-input v-model=\"saveForm.mobile\" placeholder=\"请输入联系手机\" suffix-icon=\"“xxxx”\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"座机\" prop=\"telphone\">\r\n            <el-input v-model=\"saveForm.telphone\" placeholder=\"请输入座机\" suffix-icon=\"“xxxx”\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"省\" prop=\"shopProvince\">\r\n            <el-input v-model=\"saveForm.shopProvince\" placeholder=\"请输入省\" suffix-icon=\"“xxxx”\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"市\" prop=\"shopCity\">\r\n            <el-input v-model=\"saveForm.shopCity\" placeholder=\"请输入市\" suffix-icon=\"“xxxx”\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"区\" prop=\"shopArea\">\r\n            <el-input v-model=\"saveForm.shopArea\" placeholder=\"请输入区\" suffix-icon=\"“xxxx”\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"店铺简介\" prop=\"shopDesc\">\r\n            <el-input v-model=\"saveForm.shopDesc\" placeholder=\"请输入座机\" suffix-icon=\"“xxxx”\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"店铺logo\" prop=\"shopLogo\" style=\"width:100%;\">\r\n            <el-upload\r\n              name=\"file\"\r\n              :limit=\"1\"\r\n              action=\"/admin/upload/file\"\r\n              list-type=\"picture-card\"\r\n              :file-list=\"fileLists\"\r\n              :on-preview=\"handlePictureCardPreview\"\r\n              :on-success=\"success\"\r\n              :on-remove=\"handleRemove\"\r\n              :on-exceed=\"handleExceed\"\r\n            >\r\n              <i class=\"el-icon-plus\"></i>\r\n            </el-upload>\r\n            <el-dialog :visible.sync=\"imgDialogVisible\" size=\"full\" :modal=\"false\" title=\"查看大图片\">\r\n              <img width=\"60%\" :src=\"dialogImageUrl\" alt />\r\n            </el-dialog>\r\n          </el-form-item>\r\n          <el-form-item label=\"营业执照\" prop=\"license\" style=\"width:100%;\">\r\n            <el-upload\r\n              name=\"file\"\r\n              :limit=\"1\"\r\n              action=\"/admin/upload/file\"\r\n              list-type=\"picture-card\"\r\n              :file-list=\"fileListsRe\"\r\n              :on-preview=\"handlePictureCardPreviewRe\"\r\n              :on-success=\"successRe\"\r\n              :on-remove=\"handleRemoveRe\"\r\n              :on-exceed=\"handleExceed\"\r\n            >\r\n              <i class=\"el-icon-plus\"></i>\r\n            </el-upload>\r\n            <el-dialog :visible.sync=\"imgDialogVisibleRe\" size=\"full\" :modal=\"false\" title=\"查看大图片\">\r\n              <img width=\"60%\" :src=\"dialogImageUrlRe\" alt />\r\n            </el-dialog>\r\n          </el-form-item>\r\n        </el-form>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button type=\"primary\" @click=\"saveShop()\">确定</el-button>\r\n          <el-button @click=\"editVisible = false\">取消</el-button>\r\n        </div>\r\n      </el-dialog>\r\n      <!-- 抽屉列表 -->\r\n      <el-drawer\r\n        :visible.sync=\"couponDrawer\"\r\n        direction=\"rtl\"\r\n        size=\"80%\"\r\n        :destroy-on-close=\"true\"\r\n        :withHeader=\"false\"\r\n        :before-close=\"handleDrawerClose\"\r\n      >\r\n        <div style=\"margin-left:10px;margin-top:10px;\">\r\n          <!--搜索-->\r\n          <div class=\"handle-box\">\r\n            <el-button\r\n              type=\"primary\"\r\n              round\r\n              icon=\"el-icon-circle-plus-outline\"\r\n              @click=\"handleCouponAdd()\"\r\n            >添加优惠券</el-button>\r\n          </div>\r\n          <!--数据-->\r\n          <el-table\r\n            :data=\"couponList\"\r\n            :header-cell-style=\"tableHeaderColor\"\r\n            v-loading=\"innerTableDataLoading\"\r\n          >\r\n            <el-table-column label=\"序号\" type=\"index\" width=\"50\" align=\"center\"></el-table-column>\r\n            <el-table-column\r\n              prop=\"productName\"\r\n              label=\"商品名称\"\r\n              align=\"center\"\r\n              :show-overflow-tooltip=\"true\"\r\n              width=\"110px\"\r\n            ></el-table-column>\r\n            <el-table-column prop=\"couponName\" label=\"优惠券名称\" align=\"center\" width=\"110px\"></el-table-column>\r\n            <el-table-column label=\"券面值\" align=\"center\" width=\"80px\">\r\n              <template slot-scope=\"scope\">￥{{scope.row.couponAmount}}</template>\r\n            </el-table-column>\r\n            <el-table-column\r\n              prop=\"startDate\"\r\n              label=\"券开始日期\"\r\n              :formatter=\"startDateFormat\"\r\n              align=\"center\"\r\n            ></el-table-column>min_consume_amount\r\n            <el-table-column prop=\"endDate\" label=\"券截止日期\" :formatter=\"endDateFormat\" align=\"center\"></el-table-column>\r\n            <el-table-column prop=\"couponQuantity\" label=\"券数量\" align=\"center\" width=\"70px\"></el-table-column>\r\n            <el-table-column prop=\"minConsumeAmount\" label=\"最低消费金额\" align=\"center\" width=\"120px\"></el-table-column>\r\n            <el-table-column\r\n              prop=\"useCon\"\r\n              label=\"使用条件\"\r\n              :formatter=\"useConFormat\"\r\n              align=\"center\"\r\n              width=\"80px\"\r\n            ></el-table-column>\r\n            <el-table-column\r\n              prop=\"couponStatus\"\r\n              label=\"状态\"\r\n              :formatter=\"statusFormat\"\r\n              align=\"center\"\r\n              width=\"80px\"\r\n            ></el-table-column>\r\n            <el-table-column label=\"操作\" align=\"center\">\r\n              <template slot-scope=\"scope\">\r\n                <el-button\r\n                  type=\"primary\"\r\n                  icon=\"el-icon-edit\"\r\n                  circle\r\n                  @click=\"handleCouponEdit(scope.$index, scope.row)\"\r\n                ></el-button>\r\n                <el-button\r\n                  type=\"danger\"\r\n                  icon=\"el-icon-delete\"\r\n                  circle\r\n                  @click=\"handleCouponDelete(scope.$index, scope.row)\"\r\n                ></el-button>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n          <div class=\"pagination\">\r\n            <el-pagination\r\n              background\r\n              layout=\"total, prev, pager, next\"\r\n              :current-page=\"couponQuery.pageNum\"\r\n              :page-size=\"couponQuery.pageSize\"\r\n              :total=\"couponPageTotal\"\r\n              @current-change=\"handlePageChangeCoupon\"\r\n            ></el-pagination>\r\n          </div>\r\n        </div>\r\n        <!-- 嵌套抽屉 -->\r\n        <el-drawer\r\n          size=\"50%\"\r\n          :append-to-body=\"true\"\r\n          :before-close=\"handleInnerDrawerClose\"\r\n          :visible.sync=\"innerDrawer\"\r\n          :show-close=\"false\"\r\n          :withHeader=\"false\"\r\n        >\r\n          <div style=\"text-align: center;\">\r\n            <span class=\"inner-drawer-tittle\">{{innerDrawerTittle}}</span>\r\n          </div>\r\n          <el-form\r\n            :rules=\"ruleValidate\"\r\n            ref=\"saveShopCouponForm\"\r\n            :model=\"saveShopCouponForm\"\r\n            :inline=\"true\"\r\n            :lable-position=\"labelPosition\"\r\n            label-width=\"120px\"\r\n          >\r\n            <el-form-item label=\"商品选择\" prop=\"productId\">\r\n              <el-select v-model=\"saveShopCouponForm.productId\" filterable placeholder=\"请选择商品\">\r\n                <el-option\r\n                  v-for=\"item in productList\"\r\n                  :key=\"item.id\"\r\n                  :label=\"item.productName\"\r\n                  :value=\"item.id\"\r\n                ></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n            <el-form-item label=\"券名称\" prop=\"couponName\">\r\n              <el-input\r\n                v-model=\"saveShopCouponForm.couponName\"\r\n                placeholder=\"请输入券名称\"\r\n                suffix-icon=\"“xxxx”\"\r\n              ></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"券面值\" prop=\"couponAmount\">\r\n              <el-input\r\n                v-model=\"saveShopCouponForm.couponAmount\"\r\n                placeholder=\"请输入券名称\"\r\n                suffix-icon=\"“xxxx”\"\r\n              ></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"券数量\" prop=\"couponQuantity\">\r\n              <el-input\r\n                v-model=\"saveShopCouponForm.couponQuantity\"\r\n                placeholder=\"请输入券数量\"\r\n                suffix-icon=\"“xxxx”\"\r\n              ></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"单人领取限制\" prop=\"perLimit\">\r\n              <el-input\r\n                v-model=\"saveShopCouponForm.perLimit\"\r\n                placeholder=\"请输入单人领取限制\"\r\n                suffix-icon=\"“xxxx”\"\r\n              ></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"最低消费金额\" prop=\"minConsumeAmount\">\r\n              <el-input\r\n                v-model=\"saveShopCouponForm.minConsumeAmount\"\r\n                placeholder=\"请输入最低消费金额\"\r\n                suffix-icon=\"“xxxx”\"\r\n              ></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"使用条件\" prop=\"useCon\">\r\n              <el-select v-model=\"saveShopCouponForm.useCon\" placeholder=\"请选择状态\">\r\n                <el-option\r\n                  v-for=\"item in UseConList\"\r\n                  :key=\"item.id\"\r\n                  :label=\"item.name\"\r\n                  :value=\"item.id\"\r\n                ></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n            <el-form-item label=\"状态\" prop=\"couponStatus\">\r\n              <el-select v-model=\"saveShopCouponForm.couponStatus\" placeholder=\"请选择商品状态\">\r\n                <el-option\r\n                  v-for=\"item in couponStatusList\"\r\n                  :key=\"item.id\"\r\n                  :label=\"item.name\"\r\n                  :value=\"item.id\"\r\n                ></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n            <el-form-item label=\"开始时间\" prop=\"startDate\">\r\n              <el-date-picker\r\n                v-model=\"saveShopCouponForm.startDate\"\r\n                type=\"datetime\"\r\n                placeholder=\"选择开始时间\"\r\n              ></el-date-picker>\r\n            </el-form-item>\r\n            <el-form-item label=\"结束时间\" prop=\"endDate\">\r\n              <el-date-picker\r\n                v-model=\"saveShopCouponForm.endDate\"\r\n                type=\"datetime\"\r\n                placeholder=\"选择结束时间\"\r\n              ></el-date-picker>\r\n            </el-form-item>\r\n          </el-form>\r\n          <div class=\"demo-drawer__footer\" style=\"text-align:center;\">\r\n            <el-button type=\"primary\" @click=\"saveShopCoupon()\">确 定</el-button>\r\n            <el-button @click=\"innerDrawerClose()\">取 消</el-button>\r\n          </div>\r\n        </el-drawer>\r\n      </el-drawer>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nexport default {\r\n  name: \"shopManage\",\r\n  data() {\r\n    return {\r\n      UseConList: [\r\n        { id: 0, name: \"立减\" },\r\n        { id: 1, name: \"满减\" },\r\n        { id: 2, name: \"超级券\" }\r\n      ],\r\n      couponStatusList: [\r\n        { id: 0, name: \"创建\" },\r\n        { id: 1, name: \"发布\" },\r\n        { id: 2, name: \"下架\" }\r\n      ],\r\n      dialogCentr: true,\r\n      labelPosition: \"right\",\r\n      query: {\r\n        pageNum: 1,\r\n        pageSize: 10\r\n      },\r\n      couponQuery: {\r\n        pageNum: 1,\r\n        pageSize: 5\r\n      },\r\n      tableData: [],\r\n      pageTotal: 0,\r\n      couponPageTotal: 0,\r\n      bannerTypeList: [\r\n        { id: 0, typeName: \"App引导页\" },\r\n        { id: 1, typeName: \"首页轮播图\" }\r\n      ],\r\n      bannerStatusList: [\r\n        { id: 0, name: \"创建\" },\r\n        { id: 1, name: \"发布\" },\r\n        { id: 2, name: \"下架\" }\r\n      ],\r\n      dialogImageUrl: \"\",\r\n      dialogImageUrlRe: \"\",\r\n      imgDialogVisible: false,\r\n      imgDialogVisibleRe: false,\r\n      fileLists: [],\r\n      fileListsRe: [],\r\n      dialogMessage: \"\",\r\n      saveForm: {},\r\n      addOrUpdate: 0,\r\n      editVisible: false,\r\n      ruleValidate: {\r\n        couponName: [\r\n          { required: true, message: \"请输入优惠券名称\", trigger: \"blur\" }\r\n        ]\r\n      },\r\n      tableDataLoading: true,\r\n      couponList: [],\r\n      innerTableDataLoading: true,\r\n      couponDrawer: false,\r\n      selectShopId: \"\",\r\n      saveShopCouponForm: {},\r\n      innerDrawer: false,\r\n      innerDrawerTittle: \"\",\r\n      shopCouponAddOrUpdate: 0,\r\n      productList: []\r\n    };\r\n  },\r\n  created() {\r\n    this.getTableData();\r\n    this.getProductList();\r\n  },\r\n  methods: {\r\n    //关闭抽屉\r\n    handleDrawerClose(done) {\r\n      this.couponList = [];\r\n      this.couponQuery.pageNum = 1;\r\n      done();\r\n    },\r\n    /* eslint-disable no-unused-vars */\r\n    handleInnerDrawerClose(done) {\r\n      this.$confirm(\"确定关闭吗？\")\r\n        .then(_ => {\r\n          this.resetForm(\"saveShopCouponForm\");\r\n          this.saveShopCouponForm = {};\r\n          done();\r\n        })\r\n        .catch(_ => {});\r\n    },\r\n    innerDrawerClose() {\r\n      this.innerDrawer = false;\r\n      this.resetForm(\"saveShopCouponForm\");\r\n      this.saveShopCouponForm = {};\r\n    },\r\n    //查看商户优惠券列表\r\n    // eslint-disable-next-line no-unused-vars\r\n    handleMore(index, row) {\r\n      this.selectShopId = row.id;\r\n      this.couponDrawer = true;\r\n      this.innerTableDataLoading = true;\r\n      this.getCouponTableData(row.id);\r\n    },\r\n    //商户优惠券列表数据\r\n    getCouponTableData(id) {\r\n      var url = \"/coupon/listShopCoupon\";\r\n      this.couponQuery.id = id;\r\n      this.postRequest(url, this.couponQuery).then(resp => {\r\n        if (resp && resp.status == 200 && resp.data.status == \"200\") {\r\n          this.couponList = resp.data.obj.list;\r\n          this.couponPageTotal = resp.data.obj.total;\r\n          this.innerTableDataLoading = false;\r\n        }\r\n      });\r\n    },\r\n    //删除商户\r\n    handleDelete(index, row) {\r\n      this.$confirm(\"确定要删除吗？\", \"提示\", {\r\n        type: \"warning\"\r\n      })\r\n        .then(() => {\r\n          var url = \"/shop/deleteShop\";\r\n          var params = { id: row.id };\r\n          this.postRequest(url, params).then(resp => {\r\n            if (resp && resp.status == 200 && resp.data.status == \"200\") {\r\n              this.$message.success(\"删除成功\");\r\n              this.getTableData();\r\n            } else {\r\n              this.$message(\"删除失败\");\r\n            }\r\n          });\r\n        })\r\n        .catch(() => {});\r\n    },\r\n    handleCouponDelete(index, row) {\r\n      this.$confirm(\"确定要删除吗？\", \"提示\", {\r\n        type: \"warning\"\r\n      })\r\n        .then(() => {\r\n          var url = \"/coupon/deleteShopCoupon\";\r\n          var params = { id: row.id };\r\n          this.postRequest(url, params).then(resp => {\r\n            if (resp && resp.status == 200 && resp.data.status == \"200\") {\r\n              this.$message.success(\"删除成功\");\r\n              this.getCouponTableData(this.selectShopId);\r\n            } else {\r\n              this.$message(\"删除失败\");\r\n            }\r\n          });\r\n        })\r\n        .catch(() => {});\r\n    },\r\n    //保存商户\r\n    saveShop() {\r\n      this.$refs.saveForm.validate(valid => {\r\n        if (valid) {\r\n          var url = \"\";\r\n          if (this.addOrUpdate == 0) {\r\n            url = \"/shop/insertShop\";\r\n          } else if (this.addOrUpdate == 1) {\r\n            url = \"/shop/updateShop\";\r\n          }\r\n          this.saveForm.shopLogo = this.fileLists[0].url;\r\n          this.saveForm.license = this.fileListsRe[0].url;\r\n          var params = this.saveForm;\r\n          this.postRequest(url, params).then(resp => {\r\n            if (resp && resp.status == 200 && resp.data.status == \"200\") {\r\n              this.$message.success(\"保存成功\");\r\n              this.editVisible = false;\r\n              this.getTableData();\r\n            } else {\r\n              this.$message(\"保存失败\");\r\n            }\r\n          });\r\n        }\r\n      });\r\n    },\r\n    saveShopCoupon() {\r\n      var url = \"\";\r\n      if (this.shopCouponAddOrUpdate == 0) {\r\n        url = \"/coupon/insertShopCoupon\";\r\n        this.saveShopCouponForm.shopId = this.selectShopId;\r\n      } else if (this.shopCouponAddOrUpdate == 1) {\r\n        url = \"/coupon/updateShopCoupon\";\r\n      }\r\n      var params = this.saveShopCouponForm;\r\n      this.postRequest(url, params).then(resp => {\r\n        if (resp && resp.status == 200 && resp.data.status == \"200\") {\r\n          this.$message.success(\"保存成功\");\r\n          this.resetForm(\"saveShopCouponForm\");\r\n          this.saveShopCouponForm = {};\r\n          this.innerDrawer = false;\r\n          this.getCouponTableData(this.selectShopId);\r\n        } else {\r\n          this.$message(\"保存失败\");\r\n        }\r\n      });\r\n    },\r\n    //添加弹出\r\n    handleAdd() {\r\n      this.dialogMessage = \"添加店铺\";\r\n      this.addOrUpdate = 0;\r\n      this.editVisible = true;\r\n    },\r\n    handleCouponAdd() {\r\n      this.innerDrawerTittle = \"添加店铺优惠券\";\r\n      this.shopCouponAddOrUpdate = 0;\r\n      this.innerDrawer = true;\r\n    },\r\n    //编辑弹出\r\n    handleEdit(index, row) {\r\n      this.dialogMessage = \"编辑店铺\";\r\n      this.addOrUpdate = 1;\r\n      this.idx = index;\r\n      this.saveForm = JSON.parse(JSON.stringify(row));\r\n      this.fileLists = [\r\n        {\r\n          name: \"\",\r\n          url: row.shopLogo\r\n        }\r\n      ];\r\n      this.fileListsRe = [\r\n        {\r\n          name: \"\",\r\n          url: row.license\r\n        }\r\n      ];\r\n      this.editVisible = true;\r\n    },\r\n    handleCouponEdit(index, row) {\r\n      this.innerDrawerTittle = \"编辑商铺优惠券\";\r\n      this.shopCouponAddOrUpdate = 1;\r\n      this.saveShopCouponForm = JSON.parse(JSON.stringify(row));\r\n      this.innerDrawer = true;\r\n    },\r\n    //关闭弹窗\r\n    closeDialog() {\r\n      this.resetForm(\"saveForm\");\r\n      this.saveForm = {};\r\n      this.fileLists = [];\r\n      this.fileListsRe = [];\r\n    },\r\n    resetForm(formName) {\r\n      this.$refs[formName].clearValidate();\r\n    },\r\n    getTableData() {\r\n      var url = \"/shop/listShop\";\r\n      this.postRequest(url, this.query).then(resp => {\r\n        if (resp && resp.status == 200 && resp.data.status == \"200\") {\r\n          this.tableData = resp.data.obj.list;\r\n          this.pageTotal = resp.data.obj.total;\r\n          this.tableDataLoading = false;\r\n        }\r\n      });\r\n    },\r\n    getProductList() {\r\n      var url = \"/product/listUsableProduct\";\r\n      this.postRequest(url, this.query).then(resp => {\r\n        if (resp && resp.status == 200 && resp.data.status == \"200\") {\r\n          this.productList = resp.data.obj;\r\n        }\r\n      });\r\n    },\r\n    // eslint-disable-next-line no-unused-vars\r\n    tableHeaderColor(row, rowIndex) {\r\n      return \"background-color:#EBEEF5;\";\r\n    },\r\n    handlePageChange(val) {\r\n      this.tableDataLoading = true;\r\n      this.$set(this.query, \"pageNum\", val);\r\n      this.getTableData(this.query);\r\n    },\r\n    handlePageChangeCoupon(val) {\r\n      this.innerTableDataLoading = true;\r\n      this.$set(this.couponQuery, \"pageNum\", val);\r\n      this.getCouponTableData(this.selectShopId);\r\n    },\r\n    //搜索功能\r\n    handleSearch() {\r\n      this.getTableData();\r\n    },\r\n    resetQuery() {\r\n      this.query.shopName = null;\r\n      this.query.legalPerson = null;\r\n      this.query.mobile = null;\r\n      this.getTableData();\r\n    },\r\n    // eslint-disable-next-line no-unused-vars\r\n    statusFormat(row, column) {\r\n      if (row.couponStatus == 0) {\r\n        return \"创建\";\r\n      } else if (row.couponStatus == 1) {\r\n        return \"发布\";\r\n      } else if (row.couponStatus == 2) {\r\n        return \"下架\";\r\n      }\r\n    },\r\n    // eslint-disable-next-line no-unused-vars\r\n    startDateFormat(row, column) {\r\n      return this.dateFormat(row.startDate);\r\n    },\r\n    // eslint-disable-next-line no-unused-vars\r\n    endDateFormat(row, column) {\r\n      return this.dateFormat(row.endDate);\r\n    },\r\n    // eslint-disable-next-line no-unused-vars\r\n    createDateFormat(row, column) {\r\n      return this.dateFormat(row.createTime);\r\n    },\r\n    // eslint-disable-next-line no-unused-vars\r\n    dateFormat(date) {\r\n      if (date === null) {\r\n        return null;\r\n      }\r\n      let d = new Date(date); //val 为表格内取到的后台时间\r\n      let month =\r\n        d.getMonth() + 1 < 10 ? \"0\" + (d.getMonth() + 1) : d.getMonth() + 1;\r\n      let day = d.getDate() < 10 ? \"0\" + d.getDate() : d.getDate();\r\n      let hours = d.getHours() < 10 ? \"0\" + d.getHours() : d.getHours();\r\n      let min = d.getMinutes() < 10 ? \"0\" + d.getMinutes() : d.getMinutes();\r\n      let sec = d.getSeconds() < 10 ? \"0\" + d.getSeconds() : d.getSeconds();\r\n      let times =\r\n        d.getFullYear() +\r\n        \"-\" +\r\n        month +\r\n        \"-\" +\r\n        day +\r\n        \" \" +\r\n        hours +\r\n        \":\" +\r\n        min +\r\n        \":\" +\r\n        sec;\r\n      return times;\r\n    },\r\n    //删除图片\r\n    // eslint-disable-next-line no-unused-vars\r\n    handleRemove(file, fileList) {\r\n      this.fileLists = [];\r\n    },\r\n    // eslint-disable-next-line no-unused-vars\r\n    handleRemoveRe(file, fileList) {\r\n      this.fileListsRe = [];\r\n    },\r\n    //查看大图\r\n    handlePictureCardPreview(file) {\r\n      this.dialogImageUrl = file.url;\r\n      this.imgDialogVisible = true;\r\n    },\r\n    handlePictureCardPreviewRe(file) {\r\n      this.dialogImageUrlRe = file.url;\r\n      this.imgDialogVisibleRe = true;\r\n    },\r\n    //图片上传成功\r\n    // eslint-disable-next-line no-unused-vars\r\n    success(response, file, fileList) {\r\n      this.fileLists = [\r\n        {\r\n          name: file.name,\r\n          url: response.url\r\n        }\r\n      ];\r\n    },\r\n    // eslint-disable-next-line no-unused-vars\r\n    successRe(response, file, fileList) {\r\n      this.fileListsRe = [\r\n        {\r\n          name: file.name,\r\n          url: response.url\r\n        }\r\n      ];\r\n    },\r\n    // eslint-disable-next-line no-unused-vars\r\n    handleExceed(files, fileList) {\r\n      this.$message.warning(`请最多上传一个图片。`);\r\n    },\r\n    // eslint-disable-next-line no-unused-vars\r\n    useConFormat(row, column) {\r\n      if (row.useCon == 0) {\r\n        return \"立减\";\r\n      } else if (row.useCon == 1) {\r\n        return \"满减\";\r\n      } else if (row.useCon == 2) {\r\n        return \"超级券\";\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style scoped>\r\n.table-banner-img {\r\n  display: block;\r\n  margin: auto;\r\n  width: 50px;\r\n  height: 50px;\r\n}\r\n.handle-box {\r\n  margin-bottom: 10px;\r\n  text-align: left;\r\n}\r\n.name-input {\r\n  width: 200px;\r\n  margin-right: 10px;\r\n}\r\n.status-select {\r\n  margin-right: 10px;\r\n}\r\n.inner-drawer-tittle {\r\n  font-size: 18px;\r\n  color: #303133;\r\n  line-height: 50px;\r\n}\r\n</style>"]}]}