(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b76b3026"],{"0944":function(e,t,s){var n={"./SysBasic.vue":"b839","./SysMenu.vue":"4051","./SysRole.vue":"ee62","./SysUser.vue":"dfbc","./basic/MenuMana.vue":"e070","./basic/MenuRole.vue":"6b20"};function a(e){var t=i(e);return s(t)}function i(e){var t=n[e];if(!(t+1)){var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}return t}a.keys=function(){return Object.keys(n)},a.resolve=i,e.exports=a,a.id="0944"},"0a49":function(e,t,s){var n=s("9b43"),a=s("626a"),i=s("4bf8"),r=s("9def"),o=s("cd1c");e.exports=function(e,t){var s=1==e,l=2==e,c=3==e,u=4==e,d=6==e,m=5==e||d,p=t||o;return function(t,o,f){for(var h,v,b=i(t),g=a(b),y=n(o,f,3),k=r(g.length),x=0,F=s?p(t,k):l?p(t,0):void 0;k>x;x++)if((m||x in g)&&(h=g[x],v=y(h,x,b),e))if(s)F[x]=v;else if(v)switch(e){case 3:return!0;case 5:return h;case 6:return x;case 2:F.push(h)}else if(u)return!1;return d?-1:c||u?u:F}}},1169:function(e,t,s){var n=s("2d95");e.exports=Array.isArray||function(e){return"Array"==n(e)}},"20d6":function(e,t,s){"use strict";var n=s("5ca1"),a=s("0a49")(6),i="findIndex",r=!0;i in[]&&Array(1)[i](function(){r=!1}),n(n.P+n.F*r,"Array",{findIndex:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),s("9c6c")(i)},"217b":function(e,t,s){"use strict";var n=s("c166"),a=s.n(n);a.a},2574:function(e,t,s){"use strict";var n=s("f624"),a=s.n(n);a.a},"386d":function(e,t,s){"use strict";var n=s("cb7c"),a=s("83a1"),i=s("5f1b");s("214f")("search",1,function(e,t,s,r){return[function(s){var n=e(this),a=void 0==s?void 0:s[t];return void 0!==a?a.call(s,n):new RegExp(s)[t](String(n))},function(e){var t=r(s,e,this);if(t.done)return t.value;var o=n(e),l=String(this),c=o.lastIndex;a(c,0)||(o.lastIndex=0);var u=i(o,l);return a(o.lastIndex,c)||(o.lastIndex=c),null===u?-1:u.index}]})},4051:function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sysbasic-container"},[s("el-tabs",{attrs:{type:"menuMana"},model:{value:e.defaultTab,callback:function(t){e.defaultTab=t},expression:"defaultTab"}},[s("menu-mana")],1)],1)},a=[],i=s("e070"),r={name:"SysBasic",data:function(){return{defaultTab:"depMana"}},components:{"menu-mana":i["default"]}},o=r,l=(s("217b"),s("2877")),c=Object(l["a"])(o,n,a,!1,null,"ffb226a2",null);t["default"]=c.exports},"454f":function(e,t,s){s("46a7");var n=s("584a").Object;e.exports=function(e,t,s){return n.defineProperty(e,t,s)}},"46a7":function(e,t,s){var n=s("63b6");n(n.S+n.F*!s("8e60"),"Object",{defineProperty:s("d9f6").f})},"542a":function(e,t,s){"use strict";var n=s("6d3d"),a=s.n(n);a.a},"6b20":function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"menurole-header"},[s("el-input",{staticClass:"input-left",attrs:{placeholder:"请输入角色英文名称...",size:"mini"},model:{value:e.newRole,callback:function(t){e.newRole=t},expression:"newRole"}},[s("template",{slot:"prepend"},[e._v("ROLE_")])],2),s("el-input",{staticClass:"input-right",attrs:{placeholder:"请输入角色中文名字...",size:"mini"},model:{value:e.newRoleZh,callback:function(t){e.newRoleZh=t},expression:"newRoleZh"}}),s("el-button",{staticClass:"add-button",attrs:{type:"primary",size:"mini"},on:{click:e.addNewRole}},[e._v("添加角色")])],1),s("div",{staticClass:"menurole-body"},[s("el-collapse",{staticClass:"body-collapse",attrs:{accordion:""},on:{change:function(t){return e.collapseChange(e.activeColItem)}},model:{value:e.activeColItem,callback:function(t){e.activeColItem=t},expression:"activeColItem"}},e._l(e.roles,function(t,n){return s("el-collapse-item",{key:t.name,attrs:{title:t.nameZh,name:t.id}},[s("el-card",{staticClass:"box-card"},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",[e._v("可访问的资源")]),s("el-button",{staticClass:"delete-button",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(s){return e.deleteRole(t.id,t.nameZh)}}})],1),s("div",[s("el-tree",{ref:"tree",refInFor:!0,attrs:{props:e.props,data:e.treeData,"default-checked-keys":e.checkedKeys,"node-key":"id","show-checkbox":"","highlight-current":""},on:{"check-change":e.handleCheckChange}})],1),s("div",{staticClass:"card-footer"},[s("el-button",{attrs:{size:"mini"},on:{click:e.cancelUpdateRoleMenu}},[e._v("取消修改")]),s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.updateRoleMenu(n)}}},[e._v("确认修改")])],1)])],1)}),1)],1)])},a=[],i=s("fa7d"),r={name:"MenuRole",data:function(){return{loading:!1,newRole:"",newRoleZh:"",roles:[],activeColItem:-1,treeData:[],checkedKeys:[],props:{children:"children",label:"name"}}},mounted:function(){this.loading=!0,this.initRoles()},methods:{initRoles:function(){var e=this;this.getRequest("/system/basic/roles").then(function(t){e.loading=!1,t&&200==t.status&&(e.roles=t.data.obj,e.activeColItem=-1)})},addNewRole:function(){if(Object(i["c"])(this.newRole,this.newRoleZh)){this.loading=!0;var e=this;this.postRequest("/system/basic/addRole",{name:this.newRole,nameZh:this.newRoleZh}).then(function(t){e.loading=!1,t&&200==t.status&&(e.initRoles(),e.newRole="",e.newRoleZh="")})}},collapseChange:function(e){var t=e;if(""!=e){var s=this;this.getRequest("/system/basic/menuTree/"+t).then(function(e){if(e&&200==e.status){var t=e.data.obj;s.treeData=t.menus,s.checkedKeys=t.menuIds}})}},deleteRole:function(e,t){var s=this;this.$confirm("删除角色["+t+"]，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.loading=!0,s.deleteRequest("/system/basic/role/"+e).then(function(e){s.loading=!1,e&&200==e.status&&s.initRoles()})}).catch(function(){s.$message({type:"info",message:"已取消删除"})})},handleCheckChange:function(e,t,s){},cancelUpdateRoleMenu:function(){this.activeColItem=-1},updateRoleMenu:function(e){var t=this.$refs.tree[e].getCheckedKeys(!0),s=this;this.putRequest("/system/basic/updateMenuRole",{roleId:this.activeColItem,menuIds:t}).then(function(e){e&&200==e.status&&(s.activeColItem=-1)})}}},o=r,l=(s("2574"),s("2877")),c=Object(l["a"])(o,n,a,!1,null,"0e722b06",null);t["default"]=c.exports},"6d3d":function(e,t,s){},"74af":function(e,t,s){},"83a1":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"85f2":function(e,t,s){e.exports=s("454f")},a25fb:function(e,t,s){"use strict";var n=s("74af"),a=s.n(n);a.a},b10d:function(e,t,s){"use strict";var n=s("e2c8"),a=s.n(n);a.a},b839:function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sysbasic-container"},[s("el-tabs",{attrs:{type:"menuMana"},model:{value:e.defaultTab,callback:function(t){e.defaultTab=t},expression:"defaultTab"}},[s("el-tab-pane",{attrs:{label:"菜单管理",name:"menuMana"}},[s("menu-mana")],1),s("el-tab-pane",{attrs:{label:"权限管理",name:"menuRole"}},[s("menu-role")],1)],1)],1)},a=[],i=s("e070"),r=s("6b20"),o={name:"SysBasic",data:function(){return{defaultTab:"depMana"}},components:{"menu-mana":i["default"],"menu-role":r["default"]}},l=o,c=(s("542a"),s("2877")),u=Object(c["a"])(l,n,a,!1,null,"63c983e7",null);t["default"]=u.exports},c166:function(e,t,s){},cd1c:function(e,t,s){var n=s("e853");e.exports=function(e,t){return new(n(e))(t)}},dfbc:function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"sysuser-container"},[s("div",{staticClass:"header-container"},[s("el-input",{staticClass:"search-content",attrs:{placeholder:"默认展示部分用户，可以通过用户名搜索更多用户...","prefix-icon":"el-icon-search",size:"small"},model:{value:e.keyWords,callback:function(t){e.keyWords=t},expression:"keyWords"}}),s("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.searchClick}},[e._v("搜索")]),s("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:e.addUserDialogShow}},[e._v("添加用户")])],1),s("div",{staticClass:"body-container"},e._l(e.users,function(t,n){return s("div",{key:t.id,staticClass:"card-container"},[s("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.cardLoadings[n],expression:"cardLoadings[index]"}],staticClass:"user-card"},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("span",[e._v(e._s(t.name))]),s("el-button",{staticClass:"button",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(s){return e.deleteUser(t.id)}}}),s("el-button",{staticClass:"button",staticStyle:{"margin-right":"10px"},attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(s){return e.showUpdateUserView(t)}}})],1),s("div",[s("div",{staticClass:"img-container"},[s("img",{staticClass:"user-img",attrs:{src:t.userface,alt:t.name}})]),s("div",{staticClass:"info-container"},[s("span",{staticClass:"user-info"},[e._v("用户名："+e._s(t.name))]),s("span",{staticClass:"user-info"},[e._v("手机号码："+e._s(t.phone))]),s("span",{staticClass:"user-info"},[e._v("电话号码："+e._s(t.telephone))]),s("span",{staticClass:"user-info"},[e._v("地址："+e._s(t.address))]),s("div",{staticClass:"user-info user-state"},[e._v("\n              用户状态：\n              "),s("el-switch",{key:t.id,staticClass:"switch",attrs:{"active-color":"#13ce66","inactive-color":"#aaaaaa","active-text":"启用","inactive-text":"禁用"},on:{change:function(s){return e.switchChange(t.enabled,t.id,n)}},model:{value:t.enabled,callback:function(s){e.$set(t,"enabled",s)},expression:"user.enabled"}})],1),s("div",{staticClass:"user-info"},[e._v("\n              用户角色：\n              "),e._l(t.roles,function(t){return s("el-tag",{key:t.id,staticClass:"role-tag",attrs:{type:"success",size:"mini","disable-transitions":!1}},[e._v(e._s(t.nameZh))])}),s("el-popover",{directives:[{name:"loading",rawName:"v-loading",value:e.epLoadings[n],expression:"epLoadings[index]"}],attrs:{placement:"right",title:"角色列表",width:"200",trigger:"click"},on:{hide:function(s){return e.updateUserRoles(t.id,n)}}},[s("el-select",{attrs:{multiple:"",placeholder:"请选择角色"},model:{value:e.selectedRoles,callback:function(t){e.selectedRoles=t},expression:"selectedRoles"}},e._l(e.allRoles,function(e){return s("el-option",{key:e.id,attrs:{label:e.nameZh,value:e.id}})}),1),s("el-button",{staticClass:"more-button",attrs:{slot:"reference",type:"text",icon:"el-icon-more",disabled:e.moreBtnState},on:{click:function(s){return e.loadSelectedRoles(t.roles,n)}},slot:"reference"})],1)],2),s("span",{staticClass:"user-info"},[e._v("商户名称："+e._s(t.shopName))]),s("span",{staticClass:"user-info"},[e._v("描述："+e._s(t.remark))])])])])],1)}),0),e.total>e.pageSize?s("div",{staticClass:"foot-container"},[s("el-pagination",{attrs:{background:"","page-size":e.pageSize,"current-page":e.pageNum,layout:"total, prev, pager, next, jumper","page-count":7,total:e.total},on:{"current-change":e.handleCurrentChange}})],1):e._e(),s("div",{staticClass:"dialog-container"},[s("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.closeDialog}},[s("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.formLoading,expression:"formLoading"}],ref:"userForm",attrs:{model:e.userForm,rules:e.rules,"status-icon":"","label-width":"100px","label-position":"right"}},[s("el-row",[s("el-col",{attrs:{span:12}},[s("div",[s("el-form-item",{attrs:{prop:"name",label:"姓名："}},[s("el-input",{attrs:{"prefix-icon":"el-icon-edit",size:"mini",placeholder:"请输入姓名..."},model:{value:e.userForm.name,callback:function(t){e.$set(e.userForm,"name",t)},expression:"userForm.name"}})],1)],1)]),s("el-col",{attrs:{span:11,offset:1}},[s("div",[s("el-form-item",{attrs:{prop:"phone",label:"手机号码："}},[s("el-input",{attrs:{"prefix-icon":"el-icon-mobile-phone",size:"mini",placeholder:"请输入手机号码..."},model:{value:e.userForm.phone,callback:function(t){e.$set(e.userForm,"phone",t)},expression:"userForm.phone"}})],1)],1)])],1),s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{prop:"isShopAccount",label:"商户账号："}},[s("el-radio-group",{on:{change:e.isShopAccountChange},model:{value:e.userForm.isShopAccount,callback:function(t){e.$set(e.userForm,"isShopAccount",t)},expression:"userForm.isShopAccount"}},[s("el-radio",{attrs:{label:"1",border:"",size:"mini"}},[e._v("是")]),s("el-radio",{attrs:{label:"2",border:"",size:"mini"}},[e._v("否")])],1)],1)],1),s("el-col",{attrs:{span:11,offset:1}},[s("el-form-item",{attrs:{prop:"shopId",label:"选择商户："}},[s("el-select",{attrs:{disabled:e.shopDisabled,size:"mini",placeholder:"请选择商户"},model:{value:e.userForm.shopId,callback:function(t){e.$set(e.userForm,"shopId",t)},expression:"userForm.shopId"}},e._l(e.shopList,function(e){return s("el-option",{key:e.id,attrs:{label:e.shopName,value:e.id}})}),1)],1)],1)],1),s("el-row",[s("el-col",{attrs:{span:24}},[s("div",[s("el-form-item",{attrs:{prop:"address",label:"地址："}},[s("el-input",{attrs:{"prefix-icon":"el-icon-edit",size:"mini",placeholder:"请输入地址..."},model:{value:e.userForm.address,callback:function(t){e.$set(e.userForm,"address",t)},expression:"userForm.address"}})],1)],1)])],1),s("el-row",[s("el-col",{attrs:{span:24}},[s("div",[s("el-form-item",{attrs:{prop:"username",label:"用户名："}},[s("el-input",{attrs:{"prefix-icon":"el-icon-edit",size:"mini",placeholder:"请输入用户名..."},model:{value:e.userForm.username,callback:function(t){e.$set(e.userForm,"username",t)},expression:"userForm.username"}})],1)],1)])],1),s("el-row",[s("el-col",{attrs:{span:11}},[s("div",[s("el-form-item",{attrs:{prop:"password",label:"密码："}},[s("el-input",{attrs:{"prefix-icon":"el-icon-edit","show-password":"",size:"mini",placeholder:"请输入密码..."},model:{value:e.userForm.password,callback:function(t){e.$set(e.userForm,"password",t)},expression:"userForm.password"}})],1)],1)]),s("el-col",{attrs:{span:11,offset:2}},[s("div",[s("el-form-item",{attrs:{prop:"checkPass",label:"确认密码："}},[s("el-input",{attrs:{"prefix-icon":"el-icon-edit","show-password":"",size:"mini",placeholder:"请再次输入密码..."},model:{value:e.userForm.checkPass,callback:function(t){e.$set(e.userForm,"checkPass",t)},expression:"userForm.checkPass"}})],1)],1)])],1),s("el-row",[s("el-col",{attrs:{span:24}},[s("div",[s("el-form-item",{attrs:{label:"描述："}},[s("el-input",{attrs:{"prefix-icon":"el-icon-edit",size:"mini",placeholder:"请输入描述..."},model:{value:e.userForm.remark,callback:function(t){e.$set(e.userForm,"remark",t)},expression:"userForm.remark"}})],1)],1)])],1)],1),s("span",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"samll"},on:{click:function(t){return e.cancel("userForm")}}},[e._v("取消")]),s("el-button",{attrs:{size:"samll",type:"primary"},on:{click:function(t){return e.editUser("userForm")}}},[e._v("确定")])],1)],1)],1)])},a=[],i=(s("ac6a"),s("386d"),s("85f2")),r=s.n(i);function o(e,t,s){return t in e?r()(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var l={name:"SysUser",data:function(){var e=this,t=function(t,s,n){""===s?n(new Error("请再次输入密码")):s!==e.userForm.password?n(new Error("请两次输入密码不一致！")):n()},s=function(t,s,n){"1"==e.userForm.isShopAccount&&(""===s||null==s)?n(new Error("请选择商户")):n()};return o({loading:!1,keyWords:"",pageNum:1,pageSize:6,total:0,users:[],allRoles:[],cardLoadings:[],epLoadings:[],selectedRoles:[],oldRoles:[],moreBtnState:!1,currentPage:1,dialogVisible:!1,dialogTitle:"",rules:[],formLoading:!1,userForm:{name:"",phone:"",telephone:"",address:"",username:"",password:"",userface:"",remark:"",checkPass:"",shopId:"",isShopAccount:""},shopList:[],shopDisabled:!1},"rules",{name:[{required:!0,message:"请输入姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号码",trigger:"blur"},{min:11,max:11,message:"必须为11位手机号码",trigger:"blur"}],telephone:[{required:!1,message:"请输入电话号码",trigger:"blur"}],address:[{required:!0,message:"请输入地址",trigger:"blur"}],username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!1,message:"请输入密码",trigger:"blur"}],checkPass:[{validator:t,trigger:"blur"}],isShopAccount:[{required:!0,message:"请选择是否商户账号",trigger:"change"}],shopId:[{validator:s,trigger:"change"}]})},created:function(){this.getShopListData()},methods:{closeDialog:function(){this.resetForm("userForm"),this.userForm={}},resetForm:function(e){this.$refs[e].clearValidate(),this.$refs[e].resetFields()},search:function(e,t){this.pageNum=t,this.loading=!0;var s,n=this;s=""===this.keyWords?"all":this.keyWords,this.getRequestWithParams("/system/user/"+s,{pageNum:t,pageSize:this.pageSize}).then(function(e){if(n.loading=!1,e&&200==e.status){n.users=e.data.obj.users,n.total=e.data.obj.total;var t=e.data.obj.users.length;n.cardLoadings=Array.apply(null,Array(t)).map(function(e,t){return!1}),n.epLoadings=Array.apply(null,Array(t)).map(function(e,t){return!1})}})},isShopAccountChange:function(e){"1"==e?this.shopDisabled=!1:"2"===e&&(this.userForm.shopId=null,this.shopDisabled=!0)},getShopListData:function(){var e=this,t="/product/listShop",s={pageNum:1,pageSize:1e4};this.postRequest(t,s).then(function(t){t&&200==t.status&&"200"==t.data.status&&(e.shopList=t.data.obj.list)})},searchClick:function(){this.search(this.keyWords,1)},addUserDialogShow:function(){this.dialogVisible=!0,this.dialogTitle="新增用户"},initUserCards:function(){this.search(this.keyWords,1)},loadAllRoles:function(){var e=this;this.getRequest("/system/basic/roles").then(function(t){t&&200==t.status&&(e.allRoles=t.data.obj)})},showUpdateUserView:function(e){this.userForm=e,this.dialogVisible=!0,this.userForm.shopId="",this.dialogTitle="更新用户"},deleteUser:function(e){var t=this;this.loading=!0,this.deleteRequest("/system/user/"+e).then(function(e){t.loading=!1,e&&200==e.status&&200==e.data.status&&t.initUserCards()})},switchChange:function(e,t,s){this.cardLoadings.splice(s,1,!0);var n=this;this.putRequest("/system/user/",{id:t,enabled:e}).then(function(e){n.cardLoadings.splice(s,1,!1),e&&200==e.status?500==e.data.status&&n.refreshUser(t,s):n.refreshUser(t,s)})},refreshUser:function(e,t){var s=this;this.cardLoadings.splice(t,1,!0);var n=this;this.getRequest("/system/user/id/"+e).then(function(e){if(s.cardLoadings.splice(t,1,!1),e&&200==e.status){var a=e.data.obj;n.users.splice(t,1,a)}})},updateUserRoles:function(e,t){this.moreBtnState=!1,this.epLoadings.splice(t,1,!0);var s=this;this.putRequest("/system/user/roles",{userId:e,roleIds:this.selectedRoles}).then(function(n){s.epLoadings.splice(t,1,!1),n&&200==n.status&&200==n.data.status&&s.refreshUser(e,t)})},loadSelectedRoles:function(e,t){var s=this;this.moreBtnState=!0,this.selectedRoles=[],this.oldRoles=[],e.forEach(function(e){s.selectedRoles.push(e.id),s.oldRoles.push(e.id)})},handleCurrentChange:function(e){this.search(this.keyWords,e)},cancel:function(e){this.dialogVisible=!1},editUser:function(e){var t=this;this.$refs[e].validate(function(s){if(!s)return!1;t.formLoading=!0;var n=t;t.userForm.id?t.putRequest("/system/user/",t.userForm).then(function(t){n.handleResponse(n,t,e)}):t.postRequest("/system/user/",t.userForm).then(function(t){n.handleResponse(n,t,e)})})},handleResponse:function(e,t,s){e.formLoading=!1,t&&200==t.status&&200==t.data.status&&(e.initUserCards(),e.dialogVisible=!1,void 0!==e.$refs[s]&&e.$refs[s].resetFields(),e.emptyUser())},emptyUser:function(){this.userForm={name:"",phone:"",telephone:"",address:"",username:"",password:"",userface:"",remark:"",checkPass:""}}},mounted:function(){this.initUserCards(),this.loadAllRoles()}},c=l,u=(s("a25fb"),s("2877")),d=Object(u["a"])(c,n,a,!1,null,"8cf3ea5c",null);t["default"]=d.exports},e070:function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"search-container"},[s("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入菜单名称搜索菜单...",size:"mini","prefix-icon":"el-icon-search"},model:{value:e.keyWords,callback:function(t){e.keyWords=t},expression:"keyWords"}})],1),s("div",[s("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.treeLoading,expression:"treeLoading"}],ref:"tree",staticClass:"tree-style",attrs:{props:e.props,data:e.treeData,"node-key":"id","filter-node-method":e.filterNode,"highlight-current":"","render-content":e.renderContent}}),s("div",{staticClass:"dialog-container"},[s("el-dialog",{attrs:{title:"添加菜单",visible:e.dialogVisible,width:"40%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.formLoading,expression:"formLoading"}],ref:"menuForm",attrs:{model:e.menuForm,rules:e.rules,"label-position":"top","label-width":"120px"}},[s("el-form-item",{attrs:{prop:"url",label:"url拦截规则"}},[s("el-input",{attrs:{size:"mini",placeholder:"请输入url拦截规则..."},model:{value:e.menuForm.url,callback:function(t){e.$set(e.menuForm,"url",t)},expression:"menuForm.url"}})],1),s("el-form-item",{attrs:{prop:"name",label:"菜单名称"}},[s("el-input",{attrs:{size:"mini",placeholder:"请输入菜单名称..."},model:{value:e.menuForm.name,callback:function(t){e.$set(e.menuForm,"name",t)},expression:"menuForm.name"}})],1),s("el-form-item",{attrs:{prop:"component",label:"组件名称"}},[s("el-input",{attrs:{size:"mini",placeholder:"请输入组件名称..."},model:{value:e.menuForm.component,callback:function(t){e.$set(e.menuForm,"component",t)},expression:"menuForm.component"}})],1),s("el-form-item",{attrs:{prop:"path",label:"组件路由path"}},[s("el-input",{attrs:{size:"mini",placeholder:"请输入组件路由路径..."},model:{value:e.menuForm.path,callback:function(t){e.$set(e.menuForm,"path",t)},expression:"menuForm.path"}})],1),s("el-form-item",{attrs:{label:"菜单图标"}},[s("el-input",{attrs:{size:"mini",placeholder:"请输入font-awesome中对应的图表类..."},model:{value:e.menuForm.iconCls,callback:function(t){e.$set(e.menuForm,"iconCls",t)},expression:"menuForm.iconCls"}})],1),s("div",{staticClass:"check-container"},[s("el-checkbox",{model:{value:e.menuForm.keepAlive,callback:function(t){e.$set(e.menuForm,"keepAlive",t)},expression:"menuForm.keepAlive"}},[e._v("长连接")]),s("el-checkbox",{model:{value:e.menuForm.requireAuth,callback:function(t){e.$set(e.menuForm,"requireAuth",t)},expression:"menuForm.requireAuth"}},[e._v("需要权限")])],1)],1),s("span",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"samll"},on:{click:function(t){return e.cancelAddMenu("menuForm")}}},[e._v("取消")]),s("el-button",{attrs:{size:"samll",type:"primary"},on:{click:function(t){return e.addMenu("menuForm")}}},[e._v("确定")])],1)],1)],1)],1)])},a=[],i=(s("20d6"),s("7f7f"),{name:"MenuMana",data:function(){return{keyWords:"",treeLoading:!1,treeData:[],props:{children:"children",label:"name"},dialogVisible:!1,currentNode:{},currentNodeData:{},formLoading:!1,menuForm:{url:"",path:"",component:"",name:"",iconCls:"",keepAlive:!1,requireAuth:!1},rules:{url:[{required:!0,message:"请输入url拦截规则",trigger:"blur"}],path:[{required:!0,message:"请输入组件路由路径",trigger:"blur"}],component:[{required:!0,message:"请输入组件名称",trigger:"blur"}],name:[{required:!0,message:"请输入菜单名称",trigger:"blur"}]}}},watch:{keyWords:function(e){this.$refs.tree.filter(e)}},mounted:function(){this.loadAllMenus()},methods:{loadAllMenus:function(){this.treeLoading=!0;var e=this;this.getRequest("/system/basic/allMenusTree").then(function(t){e.treeLoading=!1,t&&200==t.status&&(e.treeData=t.data.obj)})},renderContent:function(e,t){var s=this,n=t.node,a=t.data;t.store;return e("span",{style:"flex:1; display: flex; align-items: center; justify-content: space-between; font-size: 14px; padding-right: 8px;"},[e("span",[n.label]),e("span",[e("el-button",{style:"font-size: 12px; padding: 3px",attrs:{type:"primary",size:"mini"},on:{click:function(){return s.showAddMenuView(a,event)}}},["添加菜单"]),e("el-button",{style:"font-size: 12px; padding: 3px",attrs:{type:"danger",size:"mini"},on:{click:function(){return s.deleteMenu(n,a,event)}}},["删除菜单"])])])},filterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},showAddMenuView:function(e,t){this.dialogVisible=!0,this.currentNodeData=e,t.stopPropagation()},deleteMenu:function(e,t,s){var n=this,a=this;this.$confirm("删除["+t.name+"]菜单，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var s=t.id;a.formLoading=!0,n.deleteRequest("/system/basic/menu/"+s).then(function(t){if(t&&200==t.status){var n=e.parent,a=n.data.children||n.data,i=a.findIndex(function(e){return e.id===s});a.splice(i,1)}})}).catch(function(){a.$message({type:"info",message:"已取消删除"})}),s.stopPropagation()},addMenu:function(e){var t=this;this.$refs[e].validate(function(s){if(!s)return!1;var n=t.currentNodeData.id,a=t;t.formLoading=!0,t.postRequest("/system/basic/menu",{url:t.menuForm.url,path:t.menuForm.path,component:t.menuForm.component,name:t.menuForm.name,iconCls:t.menuForm.iconCls,meta:{keepAlive:t.menuForm.keepAlive,requireAuth:t.menuForm.requireAuth},parentId:n}).then(function(s){if(a.formLoading=!1,s&&200==s.status){a.dialogVisible=!1;var n=s.data.obj;t.currentNodeData.children||t.$set(t.currentNodeData,"children",[]),t.currentNodeData.children.push(n),void 0!==a.$refs[e]&&a.$refs[e].resetFields()}})})},cancelAddMenu:function(e){this.dialogVisible=!1,this.$refs[e].clearValidate()}}}),r=i,o=(s("ecc8"),s("2877")),l=Object(o["a"])(r,n,a,!1,null,"85a9f2fa",null);t["default"]=l.exports},e2c8:function(e,t,s){},e853:function(e,t,s){var n=s("d3f4"),a=s("1169"),i=s("2b4c")("species");e.exports=function(e){var t;return a(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!a(t.prototype)||(t=void 0),n(t)&&(t=t[i],null===t&&(t=void 0))),void 0===t?Array:t}},ecc8:function(e,t,s){"use strict";var n=s("f0b5"),a=s.n(n);a.a},ee62:function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sysbasic-container"},[s("el-tabs",{attrs:{type:"menuMana"},model:{value:e.defaultTab,callback:function(t){e.defaultTab=t},expression:"defaultTab"}},[s("menu-role")],1)],1)},a=[],i=s("6b20"),r={name:"SysBasic",data:function(){return{defaultTab:"depMana"}},components:{"menu-role":i["default"]}},o=r,l=(s("b10d"),s("2877")),c=Object(l["a"])(o,n,a,!1,null,"5e824e57",null);t["default"]=c.exports},f0b5:function(e,t,s){},f624:function(e,t,s){}}]);
//# sourceMappingURL=chunk-b76b3026.e174cb63.js.map